(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[710],{90416:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/projects/[projectId]/read",function(){return t(83536)}])},74796:function(n,e,t){"use strict";var r=t(94776),i=t.n(r),o=t(52322),a=t(2784),u=t(3411),s=t(95468);function c(n,e,t,r,i,o,a){try{var u=n[o](a),s=u.value}catch(c){return void t(c)}u.done?e(s):Promise.resolve(s).then(r,i)}function l(n){return function(){var e=this,t=arguments;return new Promise((function(r,i){var o=n.apply(e,t);function a(n){c(o,r,i,a,u,"next",n)}function u(n){c(o,r,i,a,u,"throw",n)}a(void 0)}))}}function f(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function d(){var n=f(["\n  font-family: ",";\n  font-size: ","px;\n\n  @media (max-width: 900px) {\n    font-size: ","px;\n  }\n"]);return d=function(){return n},n}function p(){var n=f(["\n  display: inline-block;\n  color: ",";\n  animation: blink 0.5s ease-in-out 0s infinite alternate;\n  margin-inline-start: 3px;\n\n  @keyframes blink {\n    from {\n      opacity: 1;\n    }\n    to {\n      opacity: 0;\n    }\n  }\n"]);return p=function(){return n},n}var x=u.ZP.span(d(),s.kn,(function(n){return n.fontSizeDesktop}),(function(n){return n.fontSizeMobile})),v=u.ZP.span(p(),(function(n){return n.hasCursor?"currentColor":"transparent"}));e.Z=function(n){var e=n.cursor,t=void 0===e||e,r=n.onFinish,u=n.pauseLength,s=void 0===u?3e3:u,c=n.shouldErase,f=void 0===c||c,d=n.shouldLoop,p=void 0===d||d,h=n.speed,b=void 0===h?100:h,m=n.fontSizeDesktop,g=void 0===m?72:m,j=n.fontSizeMobile,k=void 0===j?54:j,w=n.text,P=(0,a.useState)(""),y=P[0],Z=P[1],C=(0,a.useState)(!0),O=C[0],S=C[1],_=(0,a.useState)(!1),z=_[0],I=_[1],T=(0,a.useCallback)((function(){return new Promise((function(n){return setTimeout(n,s)}))}),[s]),E=(0,a.useCallback)(l(i().mark((function n(){var e;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(y.length<w.length)){n.next=4;break}e=w.substring(0,y.length+1),Z(e),n.next=9;break;case 4:return n.next=6,T();case 6:f&&S(!1),I(!0),r&&r();case 9:case"end":return n.stop()}}),n)}))),[y,T,r,f,w]),A=(0,a.useCallback)(l(i().mark((function n(){var e;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!y.length){n.next=4;break}e=w.substring(0,y.length-1),Z(e),n.next=7;break;case 4:return n.next=6,T();case 6:S(!0);case 7:case"end":return n.stop()}}),n)}))),[y,T,w]);return(0,a.useEffect)((function(){var n=setInterval((function(){if(O){if(z&&!p)return;E()}else f&&A()}),b);return function(){clearInterval(n)}}),[b,E,A,f,p,O,z]),(0,o.jsxs)(x,{fontSizeDesktop:g,fontSizeMobile:k,children:[y,(0,o.jsx)(v,{hasCursor:t,children:"|"})]})}},83536:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return bn}});var r=t(94776),i=t.n(r),o=t(52322),a=t(5632),u=t(3411),s=t(2784),c=t(60138),l=t(89297),f=t(48975),d=t(17402),p=t(34406);function x(n,e,t,r,i,o,a){try{var u=n[o](a),s=u.value}catch(c){return void t(c)}u.done?e(s):Promise.resolve(s).then(r,i)}function v(n){return function(){var e=this,t=arguments;return new Promise((function(r,i){var o=n.apply(e,t);function a(n){x(o,r,i,a,u,"next",n)}function u(n){x(o,r,i,a,u,"throw",n)}a(void 0)}))}}function h(){var n,e,t=(n=["\n  query oneProjectQuery($id: String!) {\n    project(id: $id) {\n      contributors {\n        address\n      }\n      createdAt\n      creator\n      genre\n      id\n      isDeleted\n      originalLanguage\n      subtitle\n      textIpfsHash\n      translationIpfsHash\n      title\n    }\n  }\n"],e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}})));return h=function(){return t},t}var b=(0,c.Ps)(h()),m=function(n){var e=(0,f.Ge)().account,t=(0,d.a)().detailedNfts,r=(0,s.useState)(),o=r[0],a=r[1],u=(0,s.useState)(),c=u[0],x=u[1],h=(0,s.useState)(!1),m=h[0],g=h[1],j=(0,l.a)(b,{variables:{id:n}}),k=j.loading,w=j.error,P=j.data,y=(0,s.useMemo)((function(){return null===P||void 0===P?void 0:P.project}),[P]),Z=(0,s.useMemo)((function(){var n,t;return((null===P||void 0===P||null===(n=P.project)||void 0===n||null===(t=n.contributors)||void 0===t?void 0:t.map((function(n){return n.address.toLowerCase()})))||[]).includes(null===e||void 0===e?void 0:e.toLowerCase())}),[e,P]),C=(0,s.useMemo)((function(){var n;return(null===e||void 0===e?void 0:e.toLowerCase())===(null===y||void 0===y||null===(n=y.creator)||void 0===n?void 0:n.toLowerCase())}),[e,null===y||void 0===y?void 0:y.creator]),O=(0,s.useMemo)((function(){return C||Z||!!(null===t||void 0===t?void 0:t.find((function(e){return e.projectId===Number(n)})))}),[t,C,Z,n]),S=(0,s.useCallback)(v(i().mark((function t(){var r,o,u,s,c,l,f;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(g(!0),y&&e&&!w){t.next=3;break}return t.abrupt("return",null);case 3:return t.prev=4,o="".concat(p.env.NX_PUBLIC_MOONPAGE_METADATA_API,"/projects/").concat(n),t.next=8,fetch(o);case 8:return u=t.sent,t.next=11,u.json();case 11:s=t.sent,r=s.text,a(r),g(!1),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(4),g(!1);case 20:if(r){t.next=37;break}return t.prev=21,t.next=24,fetch("https://ipfs.io/ipfs/".concat(null===y||void 0===y?void 0:y.textIpfsHash));case 24:if(!(c=t.sent).ok){t.next=32;break}return t.next=28,c.text();case 28:l=t.sent,f=JSON.parse(l),a(f),g(!1);case 32:t.next=37;break;case 34:t.prev=34,t.t1=t.catch(21),g(!1);case 37:case"end":return t.stop()}}),t,null,[[4,17],[21,34]])}))),[y,e,w,n]),_=(0,s.useCallback)(v(i().mark((function t(){var r,o,a,u,s,c,l;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(g(!0),(null===y||void 0===y?void 0:y.translationIpfsHash)&&e&&!w){t.next=3;break}return t.abrupt("return",null);case 3:return t.prev=4,o="".concat(p.env.NX_PUBLIC_MOONPAGE_METADATA_API,"/projects/").concat(n),t.next=8,fetch(o);case 8:return a=t.sent,t.next=11,a.json();case 11:u=t.sent,r=u.translation,x(r),g(!1),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(4),g(!1);case 20:if(r){t.next=37;break}return t.prev=21,t.next=24,fetch("https://ipfs.io/ipfs/".concat(null===y||void 0===y?void 0:y.translationIpfsHash));case 24:if(!(s=t.sent).ok){t.next=32;break}return t.next=28,s.text();case 28:c=t.sent,l=JSON.parse(c),x(l),g(!1);case 32:t.next=37;break;case 34:t.prev=34,t.t1=t.catch(21),g(!1);case 37:case"end":return t.stop()}}),t,null,[[4,17],[21,34]])}))),[e,w,null===y||void 0===y?void 0:y.translationIpfsHash,n]),z=(0,s.useMemo)((function(){var n;return(null===y||void 0===y||null===(n=y.translationIpfsHash)||void 0===n?void 0:n.length)>0}),[y]);return(0,s.useEffect)((function(){e&&O&&S()}),[e,O,S]),(0,s.useEffect)((function(){e&&z&&_()}),[e,O,S,_,z]),(0,s.useMemo)((function(){return{allowedToRead:O,isAuthor:C,isContributor:Z,isDeleted:null===y||void 0===y?void 0:y.isDeleted,pending:m||k,project:y,text:o,translation:c,hasTranslation:z,fetchTranslation:_,textIpfsHash:null===y||void 0===y?void 0:y.textIpfsHash}}),[O,C,Z,_,z,k,m,y,o,c])},g=t(52024),j=t(48965),k=t(74796),w=t(95468),P=t(18217);function y(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function Z(){var n=y(["\n  position: relative;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  max-width: 175px;\n  margin: 0 auto;\n"]);return Z=function(){return n},n}function C(){var n=y(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 42px;\n  height: 24px;\n  border-radius: 15px;\n  background: #bebebe;\n  cursor: pointer;\n  &::after {\n    content: '';\n    display: block;\n    border-radius: 50%;\n    width: 18px;\n    height: 18px;\n    margin: 3px;\n    background: #ffffff;\n    box-shadow: 1px 3px 3px 1px rgba(0, 0, 0, 0.2);\n    transition: 0.2s;\n  }\n"]);return C=function(){return n},n}function O(){var n=y(["\n  opacity: 0;\n  z-index: 1;\n  border-radius: 15px;\n  width: 42px;\n  height: 24px;\n  cursor: pointer;\n  &:checked + "," {\n    background: ",";\n    &::after {\n      content: '';\n      display: block;\n      border-radius: 50%;\n      width: 16px;\n      height: 16px;\n      margin-left: 21px;\n      transition: 0.2s;\n    }\n  }\n"]);return O=function(){return n},n}var S=u.ZP.div(Z()),_=u.ZP.label(C()),z=u.ZP.input(O(),_,w.p6),I=function(n){var e=n.isChecked,t=n.onChange,r=n.label;return(0,o.jsxs)(S,{children:[(0,o.jsx)(z,{checked:e,id:"checkbox",type:"checkbox",onChange:function(n){return t(n.target.checked)}}),(0,o.jsx)(_,{htmlFor:"checkbox"}),(0,o.jsx)(P.Z,{size:"xs",padding:"0",margin:"0 0 0 1rem",children:r})]})},T=t(44930),E=t(95937),A=t(99377),N=t(37563),M=t(53869),D=t(78639),L=t(81013),H=t(97204);function B(n,e,t,r,i,o,a){try{var u=n[o](a),s=u.value}catch(c){return void t(c)}u.done?e(s):Promise.resolve(s).then(r,i)}function X(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function F(){var n=X(["\n  margin: 4rem 6rem;\n  min-height: 100vh;\n  display: flex;\n  flex-direction: column;\n\n  border-radius: ",";\n  box-shadow: ",";\n\n  @media (max-width: 900px) {\n    margin: 2rem 2rem;\n  }\n"]);return F=function(){return n},n}function R(){var n=X(["\n  position: relative;\n  display: flex;\n  justify-content: space-between;\n"]);return R=function(){return n},n}function G(){var n=X(["\n  position: absolute;\n  top: 2rem;\n  right: 2rem;\n  z-index: 1;\n  display: flex;\n  align-items: center;\n\n  :hover {\n    cursor: pointer;\n  }\n\n  @media (max-width: 900px) {\n    top: 1rem;\n  }\n"]);return G=function(){return n},n}function U(){var n=X(["\n  border: solid ",";\n  border-width: 0 2px 2px 0;\n  display: inline-block;\n  margin-inline-start: 0.5rem;\n  padding: 3px;\n  transform: rotate(320deg);\n"]);return U=function(){return n},n}function J(){var n=X(["\n  padding: 2rem;\n  font-size: 42px;\n  font-family: ",";\n"]);return J=function(){return n},n}function K(){var n=X(["\n  display: flex;\n  justify-content: space-between;\n\n  @media (max-width: 900px) {\n    flex-direction: column;\n  }\n"]);return K=function(){return n},n}function W(){var n=X(["\n  padding-inline: 2rem;\n  margin-block-end: 1rem;\n\n  ","\n"]);return W=function(){return n},n}function $(){var n=X(["\n  font-family: ",";\n"]);return $=function(){return n},n}function q(){var n=X(["\n  font-family: ",";\n"]);return q=function(){return n},n}function Q(){var n=X(["\n  flex: 1;\n  padding: 2rem;\n  margin-block-end: 1rem;\n\n  ",";\n"]);return Q=function(){return n},n}function V(){var n=X(["\n  position: relative;\n  width: 100%;\n  height: 90px;\n"]);return V=function(){return n},n}function Y(){var n=X([""]);return Y=function(){return n},n}function nn(){var n=X(["\n  width: 180px;\n"]);return nn=function(){return n},n}function en(){var n=X(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n"]);return en=function(){return n},n}var tn=function(n){return"\n  animation: fadein ".concat(n,"s;\n\n  @keyframes fadein {\n      from { opacity: 0; }\n      to   { opacity: 1; }\n  }\n")},rn=u.ZP.div(F(),w.B,(function(n){return n.theme.BASE_BOX_SHADOW})),on=u.ZP.div(R()),an=u.ZP.div(G()),un=u.ZP.i(U(),(function(n){return n.theme.MAIN_TEXT_COLOR})),sn=u.ZP.div(J(),w.cr),cn=u.ZP.div(K()),ln=u.ZP.div(W(),tn(2)),fn=u.ZP.h3($(),w.cr),dn=u.ZP.h3(q(),w.cr),pn=u.ZP.div(Q(),tn(4)),xn=u.ZP.div(V()),vn=(u.ZP.p(Y()),u.ZP.div(nn())),hn=u.ZP.div(en()),bn=function(){var n,e=(0,a.useRouter)(),t=(0,L.F)(),r=(0,g.W)(),u=(0,M.Z)().uploadText,c=(0,N.v)(),l=c.updateText,f=c.updateTextStatus,d=m(r),p=d.allowedToRead,x=d.isAuthor,v=d.isDeleted,h=d.project,b=d.text,w=d.textIpfsHash,y=d.pending,Z=d.translation,C=d.hasTranslation,O=(0,s.useState)(!1),S=O[0],_=O[1],z=(0,s.useState)(!1),X=z[0],F=z[1],R=(0,s.useState)(),G=R[0],U=R[1],J=(0,s.useState)(!0),K=J[0],W=J[1],$=(0,s.useMemo)((function(){return null!==G&&void 0!==G?G:b}),[b,G]),q=(0,s.useCallback)((function(n){n.preventDefault(),e.push("/projects/".concat(h.id))}),[h,e]),Q=(0,s.useCallback)((function(){X&&K&&U(void 0),F(!X)}),[X,K]),V=(0,s.useCallback)((n=i().mark((function n(){var e;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(b&&w&&r){n.next=2;break}return n.abrupt("return",null);case 2:return n.next=4,u(G);case 4:return e=n.sent,n.next=7,l({projectId:r,text:G,textIpfsHash:e,oldTextIpfsHash:w,onSuccess:function(){W(!1),F(!1)},onError:void 0});case 7:case"end":return n.stop()}}),n)})),function(){var e=this,t=arguments;return new Promise((function(r,i){var o=n.apply(e,t);function a(n){B(o,r,i,a,u,"next",n)}function u(n){B(o,r,i,a,u,"throw",n)}a(void 0)}))}),[G,w,r,b,l,u]),Y=(0,s.useCallback)((function(){if(b&&!S)return x&&X?(0,o.jsxs)(hn,{children:[(0,o.jsx)(E.Z,{text:$,onKeyDown:function(n){return U(n)},isDisabled:["confirming","waiting"].includes(f)}),(0,o.jsx)(D.Z,{onClick:V,text:"Update",loading:["confirming","waiting"].includes(f),disabled:["confirming","waiting"].includes(f),margin:"1rem 0 0 0"})]}):(0,o.jsx)(T.Z,{text:K?b:$})}),[V,x,X,K,b,$,S,f]),nn=(0,s.useCallback)((function(){if(Z&&S)return x&&X?(0,o.jsx)(E.Z,{text:Z,onKeyDown:function(){}}):(0,o.jsx)(T.Z,{text:Z})}),[x,X,Z,S]);return!h||v?(0,o.jsx)(rn,{children:(0,o.jsx)(P.Z,{size:"xl",children:"The project you are looking for does not exist :("})}):y?(0,o.jsx)(rn,{children:(0,o.jsx)(j.Z,{height:530})}):p||y?(0,o.jsxs)(rn,{theme:t,children:[(0,o.jsxs)(on,{children:[(0,o.jsx)(sn,{children:(0,o.jsx)(k.Z,{cursor:!1,shouldErase:!1,shouldLoop:!1,text:h.title})}),(0,o.jsxs)(an,{onClick:q,children:["Back to Project",(0,o.jsx)(un,{className:"arrow",theme:t})]})]}),(0,o.jsxs)(cn,{children:[h.subtitle&&(0,o.jsx)(ln,{children:(0,o.jsx)(fn,{children:h.subtitle})}),(0,o.jsx)(ln,{children:(0,o.jsxs)(dn,{children:[(0,o.jsx)("span",{children:"By "}),(0,o.jsx)(H.Z,{account:h.creator})]})})]}),h.originalLanguage&&(0,o.jsxs)(ln,{children:[(0,o.jsx)(fn,{children:"Original Language: ".concat(h.originalLanguage)}),C&&(0,o.jsx)(vn,{children:(0,o.jsx)(I,{label:"Translation",onChange:function(n){_(n)},isChecked:S})})]}),(0,o.jsxs)(pn,{children:[x&&(0,o.jsx)(xn,{children:(0,o.jsx)(A.Z,{disabled:!b||y,onClick:Q,isEditing:X})}),Y(),nn()]})]}):(0,o.jsx)(rn,{children:(0,o.jsx)(P.Z,{size:"l",children:"Sorry, you need to own an NFT to read this."})})}}},function(n){n.O(0,[774,888,179],(function(){return e=90416,n(n.s=e);var e}));var e=n.O();_N_E=e}]);